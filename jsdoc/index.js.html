<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: index.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: index.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/**
**********************************************
* Login program with JSON Database
* @author Richard Fehling, MVT21 EC Utbildning
* @file store DB in Local storage
**********************************************
*/
//Array for users
let users = [];
//Admin user ID to be updated
let adminID = "";
//Boolean for create account
let accountCreation = false;

//DOM variables
let helpTxt = document.getElementById("help");
let createOrLogin = document.getElementById("createOrLogin");
let reset = document.getElementById("reset");
let actionButton = document.getElementById("actionButton");
let header = document.getElementById("header");
let form = document.getElementById("login");

//Clear text
let clearTextID = document.getElementById("userID");
let clearTextPass = document.getElementById("password");

//Outputs text
let output1 = document.getElementById("output1");
let output2 = document.getElementById("output2");

//Button functions
helpTxt.onclick = help;
createOrLogin.onclick = createAccount;
reset.onclick = resetSuccess;
clearTextID.onclick = resetSuccess;
clearTextPass.onclick = resetSuccess;
actionButton.onclick = login;

//Put prerequsites info on page
resetSuccess();
//Check if database is available
setUpDB();
setUpAdmin();    

/**
 * @function  setUpDB
 * Check if DB available and load into users[]
 */
//Functions
function setUpDB(){
    if (localStorage.getItem("myLoginDB") !== null) {
        let textDB = localStorage.getItem("myLoginDB");
        users = JSON.parse(textDB);
        }
}

/**
 * @function setUpAdmin
 * Check if admin User ID has been changed and load into adminID
 */
function setUpAdmin(){
    if (localStorage.getItem("newAdminID") === null) {
        adminID = "admin";
        } else {
            adminID = localStorage.getItem("newAdminID");
        }
}

/**
 * @function Login
 * Main function for login or create account
 * Reads object of User class
 */
function login() {
    //Make object of User        
    let user = new User(form.userID.value.trim(), form.password.value.trim());

    if (accountCreation){
        if (!user.checkUserInDB() &amp;&amp; user.validateUserID() &amp;&amp; user.validatePassword()){
            //Add to user ArrayList
            user.addUserToUsers();
            output1.innerHTML = "Login credentials&lt;br>succesfully created!";
        } else alert(errors(1));

    } else {
        if (user.checkUserInDB()){
            //Check password
            if (user.checkPassword()){
                //If you're admin
                if (user.userID.toLocaleLowerCase() === adminID.toLocaleLowerCase()){
                    pageRedirect();
                }
                output1.innerHTML = "CORRECT&lt;br>You're logged in";
                output2.innerHTML = "Reset to remove this message";
            } 
        } else alert(errors(2));                
    }
}

/**
 * @function createAccount
 * GUI setup for creating account
 */
function createAccount(){
    accountCreation = true;
    //Change GUI
    header.innerHTML = "Create Account";
    actionButton.value = "CREATE";
    createOrLogin.value = "Go To Login";
    createOrLogin.onclick = goToLogin;
}

/**
 * @function goToLogin
 * GUI setup for login
 */
function goToLogin(){
    accountCreation = false;
    //Change GUI
    resetSuccess();
    header.innerHTML = "Login";
    actionButton.value = "Login";
    createOrLogin.value = "Create Account";
    createOrLogin.onclick = createAccount;
}

/**
 * @function help
 * Display help file
 */
function help() {
   alert(errors(6)); 
}

/**
 * @function resetSuccess
 * Cleans up GUI after creation or login
 */
function resetSuccess(){
    output1.innerHTML = "";
    output2.innerHTML = errors(5);
}

/**
 * @function pageRedirect
 * Redirect admin after login
 */
function pageRedirect() {
    window.location.replace("admin.html");
}

/**
 * @function getUsers
 * Experimental function for Selenium
 * @returns string presentation of objects in users
 */
function getUsers(){
    getUsersStr = JSON.stringify(users, null, 1);
    return getUsersStr;
}</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Global</h3><ul><li><a href="global.html#createdynamictablefordisplayofdatabase">create dynamic table fordisplay of database</a></li><li><a href="global.html#createAccountGUIsetupforcreatingaccount">createAccountGUI setup for creating account</a></li><li><a href="global.html#deleteallstoreddatainLocalstorage">delete all stored data in Local storage</a></li><li><a href="global.html#deleterowindatabaseidentifiedbyDataIDIfadmindeletesownentryandadminUserIDhasbeenchangeditwillalsodelete%2522newAdminID%2522inLocalstorage">delete row in database identified by Data IDIf admin deletes own entry and admin User ID has beenchanged it will also delete "newAdminID" in Local storage</a></li><li><a href="global.html#diplayalertwithhelptext">diplay alert with helptext</a></li><li><a href="global.html#errors">errors</a></li><li><a href="global.html#getdatabasefromLocalstoragestorelocallyin%2522adminLocalDB%2522">get database from Local storagestore locally in "adminLocalDB"</a></li><li><a href="global.html#getUsersExperimentalfunctionforSelenium">getUsersExperimental function for Selenium</a></li><li><a href="global.html#goToLoginGUIsetupforlogin">goToLoginGUI setup for login</a></li><li><a href="global.html#helpDisplayhelpfile">helpDisplay help file</a></li><li><a href="global.html#LoginMainfunctionforloginorcreateaccountReadsobjectofUserclass">LoginMain function for login or create accountReads object of User class</a></li><li><a href="global.html#pageRedirectRedirectadminafterlogin">pageRedirectRedirect admin after login</a></li><li><a href="global.html#posttodatabase">post to database</a></li><li><a href="global.html#promptIntInput">promptIntInput</a></li><li><a href="global.html#promptText">promptText</a></li><li><a href="global.html#promptTxtInput">promptTxtInput</a></li><li><a href="global.html#redirecttoindexwhenlogout">redirect to index when logout</a></li><li><a href="global.html#resetSuccessCleansupGUIaftercreationorlogin">resetSuccessCleans up GUI after creation or login</a></li><li><a href="global.html#setUpAdminCheckifadminUserIDhasbeenchangedandloadintoadminID">setUpAdminCheck if admin User ID has been changed and load into adminID</a></li><li><a href="global.html#setUpDBCheckifDBavailableandloadintousers%255B%255D">setUpDBCheck if DB available and load into users[]</a></li><li><a href="global.html#updateseitherUserIDorPassword.UpdatedefaultadminUserIDtonewIDaccordingtoprerequisites">updates either User ID or Password.Update default admin User ID to new ID accordingto prerequisites</a></li><li><a href="global.html#validatePassword">validatePassword</a></li><li><a href="global.html#validateUserID">validateUserID</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 3.6.7</a> on Wed Dec 01 2021 09:56:10 GMT+0100 (centraleuropeisk normaltid)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
